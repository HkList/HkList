import{b as ke,d as Pe,V as D,e as De,_ as A,c as qe,f as Fe,r as b,F as We,s as Me,v as xe}from"./index-DDjLtXOe.js";import{d as Ae,B as He,C as Ke,a3 as Ue,J as re,c as p,r as L,X as Ee,a9 as Re,v as Ge,L as Je,w as je,Z as ce,e as C,_ as V,R as Be,D as Xe,G as Qe,a1 as Ie,aC as fe,Q as _e,a5 as Ye,O as Ze,y as ee,Y as Ve,aD as ze,aE as er,S as Te}from"./index-vAfRy_3n.js";import{i as Ce}from"./useResizeObserver-DLx82Lkf.js";/**
 * tdesign v1.10.6
 * (c) 2024 tdesign
 * @license MIT
 */var rr={for:{type:String,default:""},help:{type:[String,Function]},label:{type:[String,Function],default:""},labelAlign:{type:String,validator:function(e){return e?["left","right","top"].includes(e):!0}},labelWidth:{type:[String,Number]},name:{type:String,default:""},requiredMark:{type:Boolean,default:void 0},rules:{type:Array},showErrorMessage:{type:Boolean,default:void 0},status:{type:String,default:""},statusIcon:{type:[Boolean,Function],default:void 0},successBorder:Boolean,tips:{type:[String,Function]}};/**
 * tdesign v1.10.6
 * (c) 2024 tdesign
 * @license MIT
 */function nr(f,e){return f.replace(/\${(.*?)}/g,function(d,c){return e[c.trim()]||""})}/**
 * tdesign v1.10.6
 * (c) 2024 tdesign
 * @license MIT
 */function Le(f,e){var d=Object.keys(f);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(f);e&&(c=c.filter(function(E){return Object.getOwnPropertyDescriptor(f,E).enumerable})),d.push.apply(d,c)}return d}function Oe(f){for(var e=1;e<arguments.length;e++){var d=arguments[e]!=null?arguments[e]:{};e%2?Le(Object(d),!0).forEach(function(c){V(f,c,d[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(d)):Le(Object(d)).forEach(function(c){Object.defineProperty(f,c,Object.getOwnPropertyDescriptor(d,c))})}return f}function Ne(f,e){return e?"".concat(f,"__").concat(e).replace(/(\[|\]\.)/g,"_"):""}var ar=Ae({name:"TFormItem",props:Oe({},rr),setup:function(e,d){var c=d.slots,E=Be(),y=ke(),de=He("form"),Q=de.globalConfig,R=Ke({CheckCircleFilledIcon:Xe,CloseCircleFilledIcon:qe,ErrorCircleFilledIcon:Qe}),k=R.CheckCircleFilledIcon,F=R.CloseCircleFilledIcon,ve=R.ErrorCircleFilledIcon,r=Ue(Pe,void 0),ne=re(),ae=re("form-item"),me=p(function(){var a,l,n=(a=(l=e.requiredMark)!==null&&l!==void 0?l:r==null?void 0:r.requiredMark)!==null&&a!==void 0?a:Q.value.requiredMark,v=U.value.filter(function(o){return o.required}).length>0;return n??v}),te=p(function(){return c.label||e.label}),ge=p(function(){return!!(r!=null&&r.colon&&te.value)}),x=re("form__label"),q=p(function(){return Fe(e.labelAlign)?r==null?void 0:r.labelAlign:e.labelAlign}),S=p(function(){return Fe(e.labelWidth)?r==null?void 0:r.labelWidth:e.labelWidth}),ye=p(function(){return[y.value.label,V(V(V(V({},"".concat(x.value,"--required"),me.value),"".concat(x.value,"--top"),te.value&&(q.value==="top"||!S.value)),"".concat(x.value,"--left"),q.value==="left"&&S.value),"".concat(x.value,"--right"),q.value==="right"&&S.value)]}),pe=function(){if(Number(S.value)!==0){var l={};return S.value&&q.value!=="top"&&(Ie(S.value)?l={width:"".concat(S.value,"px")}:l={width:S.value}),C("div",{class:ye.value,style:l},[C("label",{for:e.for||null},[E("label")]),ge.value&&Q.value.colonText])}},le=function(){var l=function(h){return C("span",{class:y.value.status},[C(h,null,null)])},n=M.value;if($.value===D.SUCCESS)return l(k);if(n!=null&&n[0]){var v=n[0].type||"error",o={error:F,warning:ve}[v]||k;return l(o)}return null},ue=function(){var l=e.statusIcon;if(l!==!1){var n=E("statusIcon",{defaultNode:le()});if(n)return C("span",{class:y.value.status},[n]);if(n!==!1&&(n=r==null?void 0:r.renderContent("statusIcon",{defaultNode:le(),params:e}),n))return n}},be=p(function(){if(!_.value)return"";if($.value===D.SUCCESS)return e.successBorder?[y.value.success,y.value.successBorder].join(" "):y.value.success;if(M.value.length){var a=M.value[0].type||"error";return a==="error"?y.value.error:y.value.warning}}),H=p(function(){return[y.value.controls,be.value]}),ie=p(function(){var a={};return S.value&&q.value!=="top"&&(Ie(S.value)?a={marginLeft:"".concat(S.value,"px")}:a={marginLeft:S.value}),a}),M=L([]),K=L([]),$=L(D.TO_BE_VALIDATED),Y=L(!1),Z=L(!1),B=function(){Z.value=!1,M.value=[],K.value=[],$.value=D.TO_BE_VALIDATED},he=function(){var l=Object.prototype.toString.call(fe(r==null?void 0:r.data,e.name)),n;return l==="[object String]"&&(n=""),l==="[object Array]"&&(n=[]),l==="[object Object]"&&(n={}),n},Se=function(){var a=A(b.mark(function l(){var n,v=arguments;return b.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(n=v.length>0&&v[0]!==void 0?v[0]:r==null?void 0:r.resetType,e.name){O.next=3;break}return O.abrupt("return");case 3:return n==="empty"?Me(r==null?void 0:r.data,e.name,he()):n==="initial"&&Me(r==null?void 0:r.data,e.name,w.value),O.next=6,Ye();case 6:Y.value?Z.value=!0:B();case 7:case"end":return O.stop()}},l)}));return function(){return a.apply(this,arguments)}}(),se=p(function(){var a;return(a=r==null?void 0:r.errorMessage)!==null&&a!==void 0?a:Q.value.errorMessage}),U=p(function(){var a;if((a=e.rules)!==null&&a!==void 0&&a.length)return e.rules;if(!e.name)return[];var l="".concat(e.name).lastIndexOf(".")||-1,n="".concat(e.name).slice(l+1);return fe(r==null?void 0:r.rules,e.name)||fe(r==null?void 0:r.rules,n)||[]}),g=function(){var a=A(b.mark(function l(n){var v,o;return b.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(o={successList:[],errorList:[],rules:[],resultList:[],allowSetValue:!1},o.rules=n==="all"?U.value:U.value.filter(function(m){return(m.trigger||"change")===n}),!(U.value.length&&!((v=o.rules)!==null&&v!==void 0&&v.length))){h.next=4;break}return h.abrupt("return",o);case 4:return o.allowSetValue=!0,h.next=7,xe(i.value,o.rules);case 7:return o.resultList=h.sent,o.errorList=o.resultList.filter(function(m){return m.result!==!0}).map(function(m){return Object.keys(m).forEach(function(J){if(!m.message&&se.value[J]){var oe=Ze(e.label)?e.label:e.name;m.message=nr(se.value[J],{name:oe,validate:m[J]})}}),m}),o.successList=o.resultList.filter(function(m){return m.result===!0&&m.message&&m.type==="success"}),h.abrupt("return",o);case 11:case"end":return h.stop()}},l)}));return function(n){return a.apply(this,arguments)}}(),t=function(){var a=A(b.mark(function l(n,v){var o,O,h,m,J,oe;return b.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return Y.value=!0,W.value=v,X.next=4,g(n);case 4:return o=X.sent,O=o.successList,h=o.errorList,m=o.rules,J=o.resultList,oe=o.allowSetValue,oe&&(K.value=O,M.value=h),m.length&&($.value=h.length?D.FAIL:D.SUCCESS),Z.value&&B(),Y.value=!1,X.abrupt("return",V({},e.name,h.length===0?!0:J));case 15:case"end":return X.stop()}},l)}));return function(n,v){return a.apply(this,arguments)}}(),u=function(){var a=A(b.mark(function l(n){var v,o,O;return b.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,g(n);case 2:return v=m.sent,o=v.errorList,O=v.resultList,m.abrupt("return",V({},e.name,o.length===0?!0:O));case 6:case"end":return m.stop()}},l)}));return function(n){return a.apply(this,arguments)}}(),s=function(l){!l&&!_e(l)||(l.length===0&&(M.value=[],$.value=D.SUCCESS),M.value=l.map(function(n){return Oe(Oe({},n),{},{result:!1})}),$.value=D.FAIL)},i=p(function(){return(r==null?void 0:r.data)&&fe(r==null?void 0:r.data,e.name)}),w=L(void 0),j=Ee(e),P=j.name,T=Re({name:P,resetHandler:B,resetField:Se,validate:t,validateOnly:u,setValidateMessage:s});Ge(function(){w.value=De(i.value),r==null||r.children.push(T)}),Je(function(){r&&(r.children=r==null?void 0:r.children.filter(function(a){return a!==T}))}),je(i,A(b.mark(function a(){return b.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t("change");case 2:case"end":return n.stop()}},a)})),{deep:!0}),je(function(){return[e.name,JSON.stringify(e.rules)].join(",")},function(){t("change")});var W=L(void 0),_=p(function(){return Ce(W.value)?W.value:Ce(e.showErrorMessage)?e.showErrorMessage:r==null?void 0:r.showErrorMessage}),I=p(function(){return[y.value.formItem,Ne(ae.value,e.name),V(V({},y.value.formItemWithHelp,z.value),y.value.formItemWithExtra,we.value)]}),z=p(function(){var a=E("help");return a?C("div",{class:y.value.help},[a]):null}),we=p(function(){var a,l=function(o){return C("div",{class:y.value.extra,title:o},[o])},n=M.value;return _.value&&n!==null&&n!==void 0&&(a=n[0])!==null&&a!==void 0&&a.message?l(n[0].message):K.value.length?l(K.value[0].message):null}),N=p(function(){var a=E("tips");if(!a)return null;var l=["".concat(ae.value,"-tips"),"".concat(ne.value,"-tips"),"".concat(ne.value,"-is-").concat(e.status||"default")];return C("div",{class:l},[a])}),G=function(){var a=A(b.mark(function l(){return b.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,t("blur");case 2:case"end":return v.stop()}},l)}));return function(){return a.apply(this,arguments)}}();return ce(We,{handleBlur:G}),function(){return C("div",{class:I.value},[pe(),C("div",{class:H.value,style:ie.value},[C("div",{class:y.value.controlsContent},[E("default"),ue()]),z.value,N.value,we.value])])}}});/**
 * tdesign v1.10.6
 * (c) 2024 tdesign
 * @license MIT
 */var tr={colon:Boolean,data:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:void 0},errorMessage:{type:Object},formControlledComponents:{type:Array},id:{type:String,default:void 0},labelAlign:{type:String,default:"right",validator:function(e){return e?["left","right","top"].includes(e):!0}},labelWidth:{type:[String,Number],default:"100px"},layout:{type:String,default:"vertical",validator:function(e){return e?["vertical","inline"].includes(e):!0}},preventSubmitDefault:{type:Boolean,default:!0},readonly:{type:Boolean,default:void 0},requiredMark:{type:Boolean,default:void 0},resetType:{type:String,default:"empty",validator:function(e){return e?["empty","initial"].includes(e):!0}},rules:{type:Object},scrollToFirstError:{type:String,validator:function(e){return e?["","smooth","auto"].includes(e):!0}},showErrorMessage:{type:Boolean,default:!0},statusIcon:{type:[Boolean,Function],default:void 0},submitWithWarningMessage:Boolean,onReset:Function,onSubmit:Function,onValidate:Function};/**
 * tdesign v1.10.6
 * (c) 2024 tdesign
 * @license MIT
 */function $e(f,e){var d=Object.keys(f);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(f);e&&(c=c.filter(function(E){return Object.getOwnPropertyDescriptor(f,E).enumerable})),d.push.apply(d,c)}return d}function lr(f){for(var e=1;e<arguments.length;e++){var d=arguments[e]!=null?arguments[e]:{};e%2?$e(Object(d),!0).forEach(function(c){V(f,c,d[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(d)):$e(Object(d)).forEach(function(c){Object.defineProperty(f,c,Object.getOwnPropertyDescriptor(d,c))})}return f}var ur=Ae({name:"TForm",props:lr({},tr),setup:function(e,d){var c=d.expose,E=Be(),y=Ee(e),de=y.disabled,Q=y.readonly;ce("formDisabled",{disabled:de}),ce("formReadonly",{readonly:Q});var R=L(null),k=L([]),F=Ee(e),ve=F.showErrorMessage,r=F.labelWidth,ne=F.labelAlign,ae=F.data,me=F.colon,te=F.requiredMark,ge=F.rules,x=F.errorMessage,q=F.resetType;ce(Pe,Re({showErrorMessage:ve,labelWidth:r,labelAlign:ne,data:ae,colon:me,requiredMark:te,rules:ge,errorMessage:x,resetType:q,children:k,renderContent:E}));var S=re("form"),ye=ke(),pe=p(function(){return[ye.value.form,V({},"".concat(S.value,"-inline"),e.layout==="inline")]}),le=re("form-item"),ue=function(t){if(Ce(t))return"";var u=Object.keys(t),s=Ve(u,1),i=s[0];if(e.scrollToFirstError){var w=Ne(le.value,i);be(w)}var j=t[i];return _e(j)?j.filter(function(P){return!P.result})[0].message:""},be=function(t){var u=R.value.getElementsByClassName(t),s=Ve(u,1),i=s[0],w=e.scrollToFirstError;w&&i&&i.scrollIntoView({behavior:w})},H=function(t,u){return!u||!_e(u)?!0:u.indexOf("".concat(t))!==-1},ie=function(t){var u=t.reduce(function(s,i){return Object.assign(s||{},i)},{});return Object.keys(u).forEach(function(s){u[s]===!0&&delete u[s]}),er(u)?!0:u},M=function(){var g=A(b.mark(function t(u){var s,i,w,j,P,T,W,_,I,z;return b.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return i=u||{},w=i.fields,j=i.trigger,P=j===void 0?"all":j,T=i.showErrorMessage,W=k.value.filter(function(G){return ee(G.validate)&&H(String(G.name),w)}).map(function(G){return G.validate(P,T)}),N.next=4,Promise.all(W);case 4:return _=N.sent,I=ie(_),z=ue(I),(s=e.onValidate)===null||s===void 0||s.call(e,{validateResult:I,firstError:z}),N.abrupt("return",I);case 9:case"end":return N.stop()}},t)}));return function(u){return g.apply(this,arguments)}}(),K=function(){var g=A(b.mark(function t(u){var s,i,w,j,P,T;return b.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return s=u||{},i=s.fields,w=s.trigger,j=w===void 0?"all":w,P=k.value.filter(function(I){return ee(I.validateOnly)&&H(String(I.name),i)}).map(function(I){return I.validateOnly(j)}),_.next=4,Promise.all(P);case 4:return T=_.sent,_.abrupt("return",ie(T));case 6:case"end":return _.stop()}},t)}));return function(u){return g.apply(this,arguments)}}(),$=L(),Y=function(t){e.preventSubmitDefault&&t&&(t.preventDefault(),t.stopPropagation()),M($.value).then(function(u){var s;(s=e.onSubmit)===null||s===void 0||s.call(e,{validateResult:u,firstError:ue(u),e:t})}),$.value=void 0},Z=function(){var g=A(b.mark(function t(u){return b.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:$.value=u,ze(R.value);case 2:case"end":return i.stop()}},t)}));return function(u){return g.apply(this,arguments)}}(),B=L(),he=function(t){var u;e.preventSubmitDefault&&t&&(t.preventDefault(),t.stopPropagation()),k.value.filter(function(s){var i;return ee(s.resetField)&&H(String(s.name),(i=B.value)===null||i===void 0?void 0:i.fields)}).forEach(function(s){var i;return s.resetField((i=B.value)===null||i===void 0?void 0:i.type)}),B.value=void 0,(u=e.onReset)===null||u===void 0||u.call(e,{e:t})},Se=function(t){B.value=t,R.value.reset()},se=function(t){k.value.forEach(function(u){ee(u.resetHandler)&&H(String(u.name),t)&&u.resetHandler()})},U=function(t){var u=Object.keys(t);if(u.length){var s=k.value.filter(function(i){return ee(i.setValidateMessage)&&u.includes("".concat(i.name))}).map(function(i){return i.setValidateMessage(t[i.name])});Promise.all(s)}};return c({validate:M,submit:Z,reset:Se,clearValidate:se,setValidateMessage:U,validateOnly:K}),function(){return C("form",{ref:R,class:pe.value,onSubmit:function(t){return Y(t)},onReset:function(t){return he(t)}},[E("default")])}}});/**
 * tdesign v1.10.6
 * (c) 2024 tdesign
 * @license MIT
 */var cr=Te(ur),dr=Te(ar);export{dr as F,cr as a};
