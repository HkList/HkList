import{y as w,d as D,r as H,x as j,k as C,f as e,e as o,F as f,M as E,o as _,g as l,j as a,h as p,l as P,a as G,t as b}from"./index-C5Ad9MSy.js";import{c as v,L as J,a as O}from"./copy-Bqw30Ro0.js";import{u as Q}from"./useCommonStore-Cfv4cazC.js";import{f as W}from"./format-e7SM1IWF.js";import{u as X,_ as Y,A as Z}from"./Aria2Dialog.vue_vue_type_script_setup_true_lang-Crm469D2.js";import{C as h,I as tt,B as et,S as ot}from"./index-CvhmcSF0.js";import{l as x}from"./link-BFKmsZvj.js";import{L as A}from"./index-DmwyhBjn.js";import{F as lt,a as nt}from"./index-BpxvjsB1.js";import{T as at}from"./index-P-UOnfMN.js";import{T as st}from"./index-DFRX6niQ.js";import"./dep-b315df3e-BM3NQ3bZ.js";import"./useVirtualScrollNew-B5_qSfcF.js";import"./useResizeObserver-J7s6DlTb.js";import"./index-Dk0M-TCo.js";import"./index-DqD-7P6i.js";import"./index-DPtkb5ky.js";import"./fake-arrow-CoNNSefR.js";import"./dep-0df090f8-DUI5xG0U.js";import"./index-jGaOwCMB.js";import"./add-rWhgnYzd.js";import"./helper-lmZs_t81.js";const it=d=>w.request("get","/user/history",{params:d}),Vt=D({__name:"index",setup(d){const c=X(),[n,S,z,B]=Q(it),I={},L=H([{colKey:"file.filename",title:"文件名",ellipsis:!0},{colKey:"ua",title:"下载UA",cell:(i,{row:t})=>e(A,{onClick:()=>v(t.ua)},{default:()=>[e(x,null,null),t.ua]}),ellipsis:!0},{colKey:"created_at",title:"解析时间",ellipsis:!0},{colKey:"size",title:"文件大小",cell:(i,{row:t})=>e(f,null,[W(t.file.size)]),ellipsis:!0}]),k=async({validateResult:i})=>{i===!0&&(n.value.token||(n.value.token="guest"),await B(),localStorage.setItem("token",n.value.token),E.success("查询成功"))};return j(()=>{n.value.token=localStorage.getItem("token")??"guest",k({validateResult:!0})}),(i,t)=>{const F=tt,g=lt,r=et,u=ot,V=nt,y=h,M=A,T=Z,K=st,R=O,U=J,$=at;return _(),C(f,null,[e(y,null,{default:o(()=>[e(V,{data:l(n),rules:I,onSubmit:k},{default:o(()=>[e(g,{name:"token",label:"卡密"},{default:o(()=>[e(F,{modelValue:l(n).token,"onUpdate:modelValue":t[0]||(t[0]=s=>l(n).token=s)},null,8,["modelValue"])]),_:1}),e(g,null,{default:o(()=>[e(u,{size:"small"},{default:o(()=>[e(r,{type:"submit"},{default:o(()=>t[1]||(t[1]=[a(" 查询 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data"])]),_:1}),e(y,null,{default:o(()=>[e(u,{direction:"vertical"},{default:o(()=>[e(T,null,{default:o(()=>[t[4]||(t[4]=a(" 下载请推荐使用Aria2下载器,如 ")),e(M,{href:"https://motrix.app/",target:"_blank"},{"prefix-icon":o(()=>[e(l(x))]),default:o(()=>[t[2]||(t[2]=a(" Motrix "))]),_:1}),t[5]||(t[5]=p("p",null,"IDM下载需要手动指定UA,点击即可复制",-1)),t[6]||(t[6]=p("p",null,"如果当前链接下载失败,请尝试更换链接,如果全部不可用可重新解析该文件",-1)),t[7]||(t[7]=p("br",null,null,-1)),e(r,{onClick:l(c).showAria2Config},{default:o(()=>t[3]||(t[3]=[a(" 修改Aria2配置 ")])),_:1},8,["onClick"])]),_:1}),e($,{"row-key":"fs_id",resizable:"","lazy-load":"",bordered:!0,data:l(z),pagination:l(S),columns:L.value},{expandedRow:o(({row:s})=>[e(U,{split:"",size:"large"},{default:o(()=>[(_(!0),C(f,null,P(s.urls,(m,N)=>(_(),G(R,{key:m},{default:o(()=>[e(u,{direction:"vertical"},{default:o(()=>[e(u,null,{default:o(()=>[e(K,{size:"large"},{default:o(()=>[a(" 第 "+b(N+1)+" 条 ",1)]),_:2},1024),e(r,{onClick:q=>l(v)(m)},{default:o(()=>t[8]||(t[8]=[a("复制")])),_:2},1032,["onClick"]),e(r,{onClick:q=>l(c).addAria2Url(m,s.filename,s.ua,16)},{default:o(()=>t[9]||(t[9]=[a("发送到Aria2下载器")])),_:2},1032,["onClick"])]),_:2},1024),p("p",null,b(m),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:1},8,["data","pagination","columns"])]),_:1})]),_:1}),e(Y)],64)}}});export{Vt as default};
