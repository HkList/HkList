import{aw as N,r as _,c as C,w as A,U as W,X as F,ba as D,bb as k}from"./index-DNBdRIqV.js";import{b as q}from"./useResizeObserver--cwdCy-z.js";import{d as J}from"./dep-b315df3e-IOYkEDkb.js";/**
 * tdesign v1.10.4
 * (c) 2024 tdesign
 * @license MIT
 */var K=J,P=N,Q="Expected a function";function Z(t,r,a){var o=!0,s=!0;if(typeof t!="function")throw new TypeError(Q);return P(a)&&(o="leading"in a?!!a.leading:o,s="trailing"in a?!!a.trailing:s),K(t,r,{leading:o,maxWait:r,trailing:s})}var ee=Z;/**
 * tdesign v1.10.4
 * (c) 2024 tdesign
 * @license MIT
 */var ae=k;function le(t,r,a){for(var o=-1,s=t.length;++o<s;){var b=t[o],h=r(b);if(h!=null&&(R===void 0?h===h&&!ae(h):a(h,R)))var R=h,f=b}return f}var O=le;function te(t,r){return t>r}var ie=te,re=O,ne=ie,ue=D;function ve(t){return t&&t.length?re(t,ue,ne):void 0}var oe=ve;function de(t,r){return t<r}var fe=de,se=O,ce=fe,he=D;function ge(t){return t&&t.length?se(t,he,ce):void 0}var be=ge;function xe(t,r){for(var a,o=-1,s=t.length;++o<s;){var b=r(t[o]);b!==void 0&&(a=a===void 0?b:a+b)}return a}var Se=xe,Re=Se,we=D;function _e(t){return t&&t.length?Re(t,we):0}var E=_e,Ie=function(r,a){var o,s,b=_([]),h=_((((o=a.value.data)===null||o===void 0?void 0:o.length)||0)*(((s=a.value.scroll)===null||s===void 0?void 0:s.rowHeight)||50)),R=_(0),f=[],m=_(0),y=_(0),I=_([0,15]),v=C(function(){var i,e,l=a.value.scroll;return l?{bufferSize:l.bufferSize||10,isFixedRowHeight:(i=l.isFixedRowHeight)!==null&&i!==void 0?i:!1,rowHeight:l.rowHeight||47,threshold:l.threshold||100,type:l.type,fixedRows:(e=l.fixedRows)!==null&&e!==void 0?e:[0,0]}:{}}),w=C(function(){var i=a.value.data;return v.value.type==="virtual"&&v.value.threshold<i.length});function M(){for(var i,e,l=(i=(e=r.value)===null||e===void 0?void 0:e.scrollTop)!==null&&i!==void 0?i:0,n=v.value.fixedRows[0],u=[],x=0,d=-1,c=-1,S=0,g=0,T=a.value.data.length;g<T;g++){var H,V=(H=f[g])!==null&&H!==void 0?H:v.value.rowHeight;if(S=S+V,S>l&&d===-1&&(d=g,d-v.value.bufferSize>0&&(x=S-V-E(u))),d===-1&&(u.push(V),u.length>v.value.bufferSize&&u.shift()),c===-1&&(S>m.value+l||g===a.value.data.length-1)&&(c=g),d!==-1&&c!==-1)break}var L=oe([d-v.value.bufferSize,0]),B=be([c+v.value.bufferSize,a.value.data.length]),G=E(f.slice(0,Math.min(L,n)));return{startIndex:L,endIndex:B,translateY:x-G}}var $=ee(function(){var i=M(),e=i.startIndex,l=i.endIndex,n=i.translateY,u=v.value.fixedRows,x=F(u,2),d=x[0],c=x[1],S=d?a.value.data.slice(0,d):[];d&&e<d&&(S=S.slice(0,e));var g=c?a.value.data.slice(a.value.data.length-c):[],T=l-a.value.data.length+1+(c??0);c&&T>0&&(g=g.slice(T)),I.value.join()!==[e,l].join()&&e>=0&&(h.value=n,b.value=S.concat(a.value.data.slice(e,l),g),I.value=[e,l])},100),Y=function(e){var l;if(!(!w.value||!e||v.value.isFixedRowHeight||!r.value)){var n=((l=e.ref.value)===null||l===void 0?void 0:l.getBoundingClientRect().height)||v.value.rowHeight,u=e.data.VIRTUAL_SCROLL_INDEX;if(f[u]!==n){var x=n-f[u];f[u]=n,R.value=R.value+x}}},j=function(){w.value&&$()},p=function(e){var l=F(e,1),n=l[0].contentRect,u=16;Math.abs(n.width-y.value)>u&&r.value&&(r.value.scrollTop=0,h.value=0),y.value=n.width,m.value=n.height},U=function(e){e.forEach(function(l,n){l.VIRTUAL_SCROLL_INDEX=n})},z=function(e){var l=e.index,n=e.top,u=n===void 0?0:n,x=e.behavior,d=E(f.slice(0,l+1))-u;r.value.scrollTo({top:d,behavior:x||"auto"})},X=function(e){if(z(e),!v.value.isFixedRowHeight)var l,n=(l=e.time)!==null&&l!==void 0?l:60,u=setTimeout(function(){z(e),clearTimeout(u)},n)};return q(C(function(){return w.value?r.value:void 0}),p),A(function(){return[W(a.value.data),v.value,w.value,r.value]},function(){if(!(!w.value||!r.value)){var i=a.value.data;if(U(i),m.value=r.value.getBoundingClientRect().height,f.length!==a.value.data.length){var e=Array.from(f);e.length=a.value.data.length,e.fill(v.value.rowHeight||47),f=e}R.value=E(f),I.value=[0,0],$()}},{immediate:!0}),A(function(){return m.value},function(){$()}),{visibleData:b,translateY:h,scrollHeight:R,isVirtualScroll:w,handleScroll:j,handleRowMounted:Y,scrollToElement:X}};export{ee as t,Ie as u};
