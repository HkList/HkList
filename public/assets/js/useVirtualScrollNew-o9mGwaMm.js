import{ax as W,r as _,c as z,w as A,V as X,Y as F,bb as C,bc as k}from"./index-BVfyFF4r.js";import{b as q}from"./useResizeObserver-DmPoJ7Bq.js";import{d as J}from"./dep-d2ce4e2b-ao3bx8Gf.js";/**
 * tdesign v1.10.6
 * (c) 2024 tdesign
 * @license MIT
 */var K=J,P=W,Q="Expected a function";function Z(t,i,a){var d=!0,s=!0;if(typeof t!="function")throw new TypeError(Q);return P(a)&&(d="leading"in a?!!a.leading:d,s="trailing"in a?!!a.trailing:s),K(t,i,{leading:d,maxWait:i,trailing:s})}var ee=Z;/**
 * tdesign v1.10.6
 * (c) 2024 tdesign
 * @license MIT
 */var ae=k;function le(t,i,a){for(var d=-1,s=t.length;++d<s;){var b=t[d],h=i(b);if(h!=null&&(S===void 0?h===h&&!ae(h):a(h,S)))var S=h,f=b}return f}var O=le;function te(t,i){return t>i}var ne=te,ie=O,re=ne,ue=C;function ve(t){return t&&t.length?ie(t,ue,re):void 0}var de=ve;function oe(t,i){return t<i}var fe=oe,se=O,ce=fe,he=C;function ge(t){return t&&t.length?se(t,he,ce):void 0}var be=ge;function xe(t,i){for(var a,d=-1,s=t.length;++d<s;){var b=i(t[d]);b!==void 0&&(a=a===void 0?b:a+b)}return a}var Re=xe,Se=Re,we=C;function _e(t){return t&&t.length?Se(t,we):0}var E=_e,Ie=function(i,a){var d,s,b=_([]),h=_((((d=a.value.data)===null||d===void 0?void 0:d.length)||0)*(((s=a.value.scroll)===null||s===void 0?void 0:s.rowHeight)||50)),S=_(0),f=[],m=_(0),D=_(0),I=_([0,15]),v=z(function(){var n,e,l=a.value.scroll;return l?{bufferSize:l.bufferSize||10,isFixedRowHeight:(n=l.isFixedRowHeight)!==null&&n!==void 0?n:!1,rowHeight:l.rowHeight||47,threshold:l.threshold||100,type:l.type,fixedRows:(e=l.fixedRows)!==null&&e!==void 0?e:[0,0]}:{}}),w=z(function(){var n=a.value.data;return v.value.type==="virtual"&&v.value.threshold<n.length});function Y(){for(var n,e,l=(n=(e=i.value)===null||e===void 0?void 0:e.scrollTop)!==null&&n!==void 0?n:0,r=v.value.fixedRows[0],u=[],x=0,o=-1,c=-1,R=0,g=0,T=a.value.data.length;g<T;g++){var H,V=(H=f[g])!==null&&H!==void 0?H:v.value.rowHeight;if(R=R+V,R>l&&o===-1&&(o=g,o-v.value.bufferSize>0&&(x=R-V-E(u))),o===-1&&(u.push(V),u.length>v.value.bufferSize&&u.shift()),c===-1&&(R>m.value+l||g===a.value.data.length-1)&&(c=g),o!==-1&&c!==-1)break}var L=de([o-v.value.bufferSize,0]),N=be([c+v.value.bufferSize,a.value.data.length]),U=E(f.slice(0,Math.min(L,r)));return{startIndex:L,endIndex:N,translateY:x-U}}var $=ee(function(){var n=Y(),e=n.startIndex,l=n.endIndex,r=n.translateY,u=v.value.fixedRows,x=F(u,2),o=x[0],c=x[1],R=o?a.value.data.slice(0,o):[];o&&e<o&&(R=R.slice(0,e));var g=c?a.value.data.slice(a.value.data.length-c):[],T=l-a.value.data.length+1+(c??0);c&&T>0&&(g=g.slice(T)),I.value.join()!==[e,l].join()&&e>=0&&(h.value=r,b.value=R.concat(a.value.data.slice(e,l),g),I.value=[e,l])},100),M=function(e){var l;if(!(!w.value||!e||v.value.isFixedRowHeight||!i.value)){var r=((l=e.ref.value)===null||l===void 0?void 0:l.getBoundingClientRect().height)||v.value.rowHeight,u=e.data.VIRTUAL_SCROLL_INDEX;if(f[u]!==r){var x=r-f[u];f[u]=r,S.value=S.value+x}}},j=function(){w.value&&$()},p=function(e){var l=F(e,1),r=l[0].contentRect;if(!a.value.preventResizeRefresh){var u=16;Math.abs(r.width-D.value)>u&&i.value&&(i.value.scrollTop=0,h.value=0),D.value=r.width,m.value=r.height}},B=function(e){e.forEach(function(l,r){l.VIRTUAL_SCROLL_INDEX=r})},y=function(e){var l=e.index,r=e.top,u=r===void 0?0:r,x=e.behavior,o=E(f.slice(0,l+1))-u;i.value.scrollTo({top:o,behavior:x||"auto"})},G=function(e){if(y(e),!v.value.isFixedRowHeight)var l,r=(l=e.time)!==null&&l!==void 0?l:60,u=setTimeout(function(){y(e),clearTimeout(u)},r)};return q(z(function(){return w.value?i.value:void 0}),p),A(function(){return[X(a.value.data),v.value,w.value,i.value]},function(){if(!(!w.value||!i.value)){var n=a.value.data;if(B(n),m.value=i.value.getBoundingClientRect().height,f.length!==a.value.data.length){var e=Array.from(f);e.length=a.value.data.length,e.fill(v.value.rowHeight||47),f=e}S.value=E(f),I.value=[0,0],$()}},{immediate:!0}),A(function(){return m.value},function(){$()}),{visibleData:b,translateY:h,scrollHeight:S,isVirtualScroll:w,handleScroll:j,handleRowMounted:M,scrollToElement:G}};export{ee as t,Ie as u};
