import{p as i,q as G,b as c,M as a}from"./index-ClQzGfh-.js";import{a as y}from"./format-DQmRoCeR.js";import{u as H}from"./useCommonStore-DGWIbvmO.js";const J=e=>i.request("get","/admin/account",{params:e}),N=e=>i.request("post","/admin/account",{data:e}),S=e=>i.request("patch","/admin/account",{data:e}),q=e=>i.request("post","/admin/account/update_info",{data:e}),O=e=>i.request("post","/admin/account/update_data",{data:e}),Q=e=>i.request("delete","/admin/account",{data:e}),V=e=>i.request("post","/admin/account/check_ban_status",{data:e}),ta=e=>i.request("post","/admin/account/get_cid_info",{data:e}),oa=G("accounts",()=>{const[e,U,$,u]=H(J,()=>{t.value=[]}),t=c([]),P=o=>{t.value=o},b=async()=>{if(t.value.length===0)return a.error("请选择账号");await q({id:t.value}),a.success("更新成功"),await u()},I=async()=>{if(t.value.length===0)return a.error("请选择账号");await Q({id:t.value}),t.value=[],a.success("删除成功"),await u()},v=c(!1),k=c({id:[],switch:!1}),R=()=>v.value=!0,C=()=>v.value=!1,x=async()=>{if(t.value.length===0)return a.error("请选择账号");await S({...k.value,id:t.value}),a.success("更新成功"),await u()},_=c(!1),B=()=>_.value=!0,E=()=>_.value=!1,m=c({id:[],prov:null}),M=async()=>{if(t.value.length===0)return a.error("请选择账号");await S({...m.value,id:t.value}),a.success("更新省份成功"),await u()},w=c(!1),T=()=>w.value=!0,K=async()=>w.value=!1,r=c("cookie"),f=c({cookie:"",cid:0,refresh_token:"",url:"",surl:"",pwd:"",dir:"",save_cookie:"",download_cookie:"",dlink_cookie:""}),L=async()=>{const o={account_type:r.value,account_data:[]},{cookie:s,refresh_token:A,surl:d,pwd:n,dir:h,save_cookie:l,download_cookie:z,dlink_cookie:F,cid:D}=f.value;r.value==="cookie"?o.account_data=[{cookie:s}]:r.value==="enterprise_cookie"?o.account_data=[{cookie:s,dlink_cookie:F,cid:D}]:r.value==="open_platform"?o.account_data=[{refresh_token:A}]:r.value==="download_ticket"&&(o.account_data=[{surl:d,pwd:n,dir:h,save_cookie:l,download_cookie:z,cid:D}]),await N(o),a.success("插入成功~"),f.value={cookie:"",refresh_token:"",cid:0,url:"",surl:"",pwd:"",dir:"",save_cookie:"",download_cookie:"",dlink_cookie:""},await u()},j=async(o,s)=>{o.stopPropagation(),(await V({id:[s]})).data.forEach(d=>{d.status.forEach((n,h)=>{let l="账号";if(d.account_type==="download_ticket"&&(l=h===0?"企业账号":"普通账号"),n.code!==200)return a.error(`${l}(${d.id})${n.message}`);if(!n.data.ban_status)return a.success(`${l}(${d.id})未被封禁`);a.warning(`${l}(${d.id})已被封禁`),a.warning(`原因: ${n.data.ban_reason}`),a.warning(`消息: ${n.data.ban_msg}`),a.warning(`开始时间: ${y(n.data.start_time)}`),a.warning(`结束时间: ${y(n.data.end_time)}`)})})},p=c({id:[],account_type:"cookie",account_data:{cookie:"",vip_type:"普通用户",expires_at:""}}),g=c(!1);return{pagination:U,selectReq:e,accountList:$,getAccounts:u,selectedRowKeys:t,handleSelectChange:P,updateInfoSelection:b,deleteSelection:I,isUpdateSwitch:v,updateSwitchReq:k,showUpdateSwitchDialog:R,hideUpdateSwitchDialog:C,updateSwitch:x,isUpdateProvDialog:_,updateProvReq:m,showUpdateProvDialog:B,hideUpdateProvDialog:E,updateProvSelection:M,isAddAccount:w,addAccountType:r,addAccountInput:f,showAddAccountDialog:T,hideAddAccountDialog:K,addAccount:L,checkAccountBanStatus:j,updateAccountDataInfo:p,isUpdatingAccountData:g,showUpdateAccountDataDialog:(o,s)=>{o.stopPropagation(),p.value={id:[s.id],account_type:s.account_type,account_data:s.account_data},g.value=!0},hideUpdateAccountDataDialog:()=>{g.value=!1},updateAccountData:async()=>{await O(p.value),a.success("编辑账户信息成功"),await q({id:p.value.id}),a.success("更新账户信息成功"),await u()}}});export{ta as g,oa as u};
