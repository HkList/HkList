import{p as v,d as x,bb as M,bc as I,e as c,f as o,g as e,o as y,b as A,n as B,i,M as g}from"./index-BlUydGuh.js";import{S as q,O as F}from"./index-DmQKD-Vd.js";import{C as L,I as O,S as $}from"./index-DlzaH1y1.js";import{a as z,F as H}from"./index-CB8fqy6i.js";import{S as R}from"./index-Bqi24OcS.js";import{L as T}from"./index-B-v2lFnZ.js";import{B as h}from"./useResizeObserver-i89Y8hdt.js";import"./fake-arrow-DJdQvvgp.js";import"./debounce-C97J7VUq.js";import"./omit-B3YBGMpO.js";import"./index-DnrHboiB.js";const D=()=>v.request("get","/admin/config/parse"),b=m=>v.request("patch","/admin/config/parse",{data:m}),N=()=>v.request("post","/admin/config/parse/test_auth"),w=x({__name:"ParseMode",props:{modelValue:{},modelModifiers:{}},emits:M(["change","blur"],["update:modelValue"]),setup(m,{emit:a}){const p=I(m,"modelValue"),_=a;return(V,u)=>{const n=F,d=q;return y(),c(d,{modelValue:p.value,"onUpdate:modelValue":u[0]||(u[0]=l=>p.value=l),onChange:u[1]||(u[1]=l=>_("change")),onBlur:u[2]||(u[2]=l=>_("blur"))},{default:o(()=>[e(n,{label:"V0免费-SVIP-盘内",value:0}),e(n,{label:"V1-SVIP-盘内",value:1}),e(n,{label:"V2-SVIP-盘外",value:2}),e(n,{label:"V3开放平台-SVIP-盘内",value:3}),e(n,{label:"V4开放平台-SVIP-盘内",value:4}),e(n,{label:"V5企业-企业套餐-盘内",value:5}),e(n,{label:"V6企业-下载卷-盘内",value:6}),e(n,{label:"V7企业-企业套餐-盘外",value:7})]),_:1},8,["modelValue"])}}}),ae=x({__name:"index",setup(m){const a=A({parser_server:"",parser_password:"",allow_folder:!1,ddddocr_server:"",token_parse_mode:1,token_user_agent:"",guest_parse_mode:1,guest_user_agent:"",token_proxy_host:"",token_proxy_password:"",guest_proxy_host:"",guest_proxy_password:"",moiu_token:""}),p={token_user_agent:[{required:!0,message:"请输入卡密解析UA"}],guest_user_agent:[{required:!0,message:"请输入游客解析UA"}]},_=async()=>{const d=await D();a.value=d.data};B(_);const V=async({validateResult:d})=>{d===!0&&(await b(a.value),g.success("保存成功"),await _())},u=()=>{switch(a.value.token_parse_mode){case 0:a.value.token_user_agent="netdisk;7.42.0.5;PC";break;case 3:a.value.token_user_agent="pan.baidu.com";break;case 4:a.value.token_user_agent="Mozilla/5.0 (hklist;netdisk;svip)";break;case 1:case 2:case 5:case 6:case 7:a.value.token_user_agent="netdisk;P2SP;3.0.20.138";break;default:g.error("未知解析模式");break}switch(a.value.guest_parse_mode){case 0:a.value.guest_user_agent="netdisk;7.42.0.5;PC";break;case 3:a.value.guest_user_agent="pan.baidu.com";break;case 4:a.value.guest_user_agent="Mozilla/5.0 (hklist;netdisk;svip)";break;case 1:case 2:case 5:case 6:case 7:a.value.guest_user_agent="netdisk;P2SP;3.0.20.138";break;default:g.error("未知解析模式");break}},n=async()=>{await b(a.value);const d=await N();g.success(`测试通过,有效期至: ${d.data.expires_at}`)};return(d,l)=>{const r=O,s=z,U=R,f=T,k=h,S=$,C=H,P=L;return y(),c(P,null,{default:o(()=>[e(C,{data:a.value,rules:p,onSubmit:V,labelWidth:220},{default:o(()=>[e(s,{name:"parser_server",label:"授权服务器"},{default:o(()=>[e(r,{modelValue:a.value.parser_server,"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.parser_server=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"parser_password",label:"授权密钥"},{default:o(()=>[e(r,{modelValue:a.value.parser_password,"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.parser_password=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"allow_folder",label:"允许解析文件夹",help:"未完工"},{default:o(()=>[e(U,{modelValue:a.value.allow_folder,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.allow_folder=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"ddddocr_server",label:"OCR服务器"},{default:o(()=>[e(r,{modelValue:a.value.ddddocr_server,"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.ddddocr_server=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"ddddocr_server_github",label:"OCR服务器开源地址"},{default:o(()=>[e(f,{href:"https://github.com/HkList/ddddocr",target:"_blank"},{default:o(()=>l[13]||(l[13]=[i(" 点击打开 ")])),_:1})]),_:1}),e(s,{name:"token_parse_mode",label:"卡密解析模式"},{default:o(()=>[e(w,{modelValue:a.value.token_parse_mode,"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.token_parse_mode=t),onChange:u,onBlur:u},null,8,["modelValue"])]),_:1}),e(s,{name:"token_user_agent",label:"卡密解析UA"},{default:o(()=>[e(r,{modelValue:a.value.token_user_agent,"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.token_user_agent=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"guest_parse_mode",label:"游客解析模式"},{default:o(()=>[e(w,{modelValue:a.value.guest_parse_mode,"onUpdate:modelValue":l[6]||(l[6]=t=>a.value.guest_parse_mode=t),onChange:u,onBlur:u},null,8,["modelValue"])]),_:1}),e(s,{name:"guest_user_agent",label:"游客解析UA"},{default:o(()=>[e(r,{modelValue:a.value.guest_user_agent,"onUpdate:modelValue":l[7]||(l[7]=t=>a.value.guest_user_agent=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"token_proxy_host",label:"卡密下载代理服务器"},{default:o(()=>[e(r,{modelValue:a.value.token_proxy_host,"onUpdate:modelValue":l[8]||(l[8]=t=>a.value.token_proxy_host=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"token_proxy_password",label:"卡密下载代理服务器密钥"},{default:o(()=>[e(r,{modelValue:a.value.token_proxy_password,"onUpdate:modelValue":l[9]||(l[9]=t=>a.value.token_proxy_password=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"guest_proxy_host",label:"游客下载代理服务器"},{default:o(()=>[e(r,{modelValue:a.value.guest_proxy_host,"onUpdate:modelValue":l[10]||(l[10]=t=>a.value.guest_proxy_host=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"token_proxy_password",label:"游客下载代理服务器密钥"},{default:o(()=>[e(r,{modelValue:a.value.guest_proxy_password,"onUpdate:modelValue":l[11]||(l[11]=t=>a.value.guest_proxy_password=t)},null,8,["modelValue"])]),_:1}),e(s,{name:"proxy_host_github",label:"下载代理服务器开源地址"},{default:o(()=>[e(f,{href:"https://github.com/HkList/HkList/blob/master/nginx.conf",target:"_blank"},{default:o(()=>l[14]||(l[14]=[i(" 点击打开 ")])),_:1})]),_:1}),e(s,{name:"moiu_token",label:"XiaoMo ShareDownload Token",help:"获取方式暂不公开"},{default:o(()=>[e(r,{modelValue:a.value.moiu_token,"onUpdate:modelValue":l[12]||(l[12]=t=>a.value.moiu_token=t)},null,8,["modelValue"])]),_:1}),e(s,null,{default:o(()=>[e(S,{size:"small"},{default:o(()=>[e(k,{type:"submit"},{default:o(()=>l[15]||(l[15]=[i(" 保存 ")])),_:1}),e(k,{onClick:n},{default:o(()=>l[16]||(l[16]=[i(" 测试授权 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data"])]),_:1})}}});export{ae as default};
