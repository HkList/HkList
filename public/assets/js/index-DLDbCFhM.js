import{T as K,d as w,r as N,D as h,k,f as t,e,F as u,R as q,o as m,g as l,j as p,l as D,a as H,t as y,h as M}from"./index-CXsQrBlN.js";import{c as b,L as U,a as $}from"./copy-BEeO7rZN.js";import{u as j}from"./useCommonStore-BszmuRxV.js";import{f as A}from"./format-DM3J8B0o.js";import{C as E,I as P,B as G,S as J}from"./index-BrMISRL3.js";import{L as O}from"./index-DRFPT3xl.js";import{F as Q,a as W}from"./index-BPdgWXY4.js";import{T as X}from"./index-Ca7uAS7r.js";import{T as Y}from"./index-BVzw0HaR.js";import"./dep-b315df3e-Bhs51j-8.js";import"./useVirtualScrollNew-XSuNWHRp.js";import"./useResizeObserver-68q0ST9u.js";import"./index-B4qoRM2T.js";import"./fake-arrow-RRoJ920x.js";import"./dep-0df090f8-B8El8jRh.js";import"./index-BXxGOXeh.js";import"./add-B9qLOlVE.js";import"./helper-DL-Ugjgz.js";const Z=c=>K.request("get","/user/history",{params:c}),bt=w({__name:"index",setup(c){const[a,v,C,z]=j(Z),B={},L=N([{colKey:"file.filename",title:"文件名",ellipsis:!0},{colKey:"ua",title:"下载UA",cell:(s,{row:o})=>t(O,{onClick:()=>b(o.ua)},{default:()=>[o.ua]}),ellipsis:!0},{colKey:"created_at",title:"解析时间",ellipsis:!0},{colKey:"size",title:"文件大小",cell:(s,{row:o})=>t(u,null,[A(o.file.size)]),ellipsis:!0}]),_=async({validateResult:s})=>{s===!0&&(a.value.token||(a.value.token="guest"),await z(),localStorage.setItem("token",a.value.token),q.success("查询成功"))};return h(()=>{a.value.token=localStorage.getItem("token")??"guest",_({validateResult:!0})}),(s,o)=>{const S=P,d=Q,f=G,n=J,x=W,g=E,F=Y,I=$,T=U,V=X;return m(),k(u,null,[t(g,null,{default:e(()=>[t(x,{data:l(a),rules:B,onSubmit:_},{default:e(()=>[t(d,{name:"token",label:"卡密"},{default:e(()=>[t(S,{modelValue:l(a).token,"onUpdate:modelValue":o[0]||(o[0]=r=>l(a).token=r)},null,8,["modelValue"])]),_:1}),t(d,null,{default:e(()=>[t(n,{size:"small"},{default:e(()=>[t(f,{type:"submit"},{default:e(()=>o[1]||(o[1]=[p(" 查询 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data"])]),_:1}),t(g,null,{default:e(()=>[t(V,{"row-key":"fs_id",resizable:"","lazy-load":"",bordered:!0,data:l(C),pagination:l(v),columns:L.value},{expandedRow:e(({row:r})=>[t(T,{split:"",size:"large"},{default:e(()=>[(m(!0),k(u,null,D(r.urls,(i,R)=>(m(),H(I,{key:i},{default:e(()=>[t(n,{direction:"vertical"},{default:e(()=>[t(n,null,{default:e(()=>[t(F,{size:"large"},{default:e(()=>[p(" 第 "+y(R+1)+" 条 ",1)]),_:2},1024),t(f,{onClick:tt=>l(b)(i)},{default:e(()=>o[2]||(o[2]=[p("复制")])),_:2},1032,["onClick"])]),_:2},1024),M("p",null,y(i),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:1},8,["data","pagination","columns"])]),_:1})],64)}}});export{bt as default};
