import{x as d,d as U,r as S,v as A,a as B,b as t,o as F,e,g as v,M as m}from"./index-D7B0QjbI.js";import{C as M,I as P,S as q}from"./index-6GxuIOSm.js";import{F as y,a as I}from"./index-B4_C_dYJ.js";import{O as z,S as N}from"./index-D9OGCiTF.js";import{S as O}from"./index-g3wdU_GT.js";import{B as T}from"./useResizeObserver-kSTnZ_a2.js";import"./dep-d2ce4e2b-DiHX5kPw.js";import"./fake-arrow-BtW9I7zp.js";import"./index-B-NgG7Av.js";const D=()=>d.request("get","/admin/config/parse"),K=p=>d.request("patch","/admin/config/parse",{data:p}),R=()=>d.request("post","/admin/config/parse/test_auth"),Q=U({__name:"Parse",setup(p){const a=S({parser_server:"",parser_password:"",parse_mode:1,user_agent:"",use_exploit:!1,allow_folder:!1}),V={user_agent:[{required:!0,message:"请输入下载UA"}]},_=async()=>{const u=await D();a.value=u.data};A(_);const b=async({validateResult:u})=>{u===!0&&(await K(a.value),m.success("保存成功"),await _())},i=()=>{switch(a.value.parse_mode){case 0:a.value.user_agent="netdisk;7.42.0.5;PC";break;case 3:a.value.user_agent="pan.baidu.com";break;case 4:a.value.user_agent="Mozilla/5.0 (hklist-laravel;netdisk;svip)";break;case 1:case 2:case 5:case 6:a.value.user_agent="netdisk;P2SP;3.0.20.88";break;default:m.error("未知解析模式");break}},g=async()=>{const u=await R();m.success(`测试通过,有效期至: ${u.data.expires_at}`)};return(u,l)=>{const n=P,s=y,r=z,w=N,f=O,c=T,k=q,x=I,C=M;return F(),B(C,null,{default:t(()=>[e(x,{data:a.value,rules:V,onSubmit:b,labelWidth:150},{default:t(()=>[e(s,{name:"parser_server",label:"授权服务器"},{default:t(()=>[e(n,{modelValue:a.value.parser_server,"onUpdate:modelValue":l[0]||(l[0]=o=>a.value.parser_server=o)},null,8,["modelValue"])]),_:1}),e(s,{name:"parser_password",label:"授权密钥"},{default:t(()=>[e(n,{modelValue:a.value.parser_password,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value.parser_password=o)},null,8,["modelValue"])]),_:1}),e(s,{name:"parse_mode",label:"解析模式"},{default:t(()=>[e(w,{modelValue:a.value.parse_mode,"onUpdate:modelValue":l[2]||(l[2]=o=>a.value.parse_mode=o),onChange:i,onBlur:i},{default:t(()=>[e(r,{label:"V0免费",value:0}),e(r,{label:"V1盘内",value:1}),e(r,{label:"V2盘外",value:2}),e(r,{label:"V3开放平台",value:3}),e(r,{label:"V4开放平台",value:4}),e(r,{label:"V5企业模式",value:5}),e(r,{label:"V6下载卷",value:6})]),_:1},8,["modelValue"])]),_:1}),e(s,{name:"user_agent",label:"下载UA"},{default:t(()=>[e(n,{modelValue:a.value.user_agent,"onUpdate:modelValue":l[3]||(l[3]=o=>a.value.user_agent=o)},null,8,["modelValue"])]),_:1}),e(s,{name:"use_exploit",label:"启用漏洞模式",help:"小于100M的文件使用漏洞模式, 需要准备无会员的CK账号, 不支持V0"},{default:t(()=>[e(f,{modelValue:a.value.use_exploit,"onUpdate:modelValue":l[4]||(l[4]=o=>a.value.use_exploit=o)},null,8,["modelValue"])]),_:1}),e(s,{name:"allow_folder",label:"允许客户端解析文件夹"},{default:t(()=>[e(f,{modelValue:a.value.allow_folder,"onUpdate:modelValue":l[5]||(l[5]=o=>a.value.allow_folder=o)},null,8,["modelValue"])]),_:1}),e(s,null,{default:t(()=>[e(k,{size:"small"},{default:t(()=>[e(c,{type:"submit"},{default:t(()=>l[6]||(l[6]=[v(" 保存 ")])),_:1}),e(c,{onClick:g},{default:t(()=>l[7]||(l[7]=[v(" 测试授权 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data"])]),_:1})}}});export{Q as default};
